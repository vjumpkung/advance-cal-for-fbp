var Z=Object.defineProperty;var J=(t,s,e)=>s in t?Z(t,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[s]=e;var v=(t,s,e)=>J(t,typeof s!="symbol"?s+"":s,e);import{r as E,a as X}from"./vendor-wpXbf5jk.js";import{B as C,Q as Y}from"./react-toastify-Df8KVf6C.js";import{F as Q}from"./file-saver-B7T6XPHc.js";import{H as tt}from"./react-helmet-CuerYPg1.js";import{a as M}from"./axios-DXsv3KKR.js";import{z as n}from"./zod-DXqQCM1T.js";import{l as h}from"./litegraph.js-D6XMNgl8.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const r of l.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function e(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(a){if(a.ep)return;a.ep=!0;const l=e(a);fetch(a.href,l)}})();var F={exports:{}},R={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var et=E,ot=Symbol.for("react.element"),it=Symbol.for("react.fragment"),st=Object.prototype.hasOwnProperty,nt=et.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,rt={key:!0,ref:!0,__self:!0,__source:!0};function $(t,s,e){var i,a={},l=null,r=null;e!==void 0&&(l=""+e),s.key!==void 0&&(l=""+s.key),s.ref!==void 0&&(r=s.ref);for(i in s)st.call(s,i)&&!rt.hasOwnProperty(i)&&(a[i]=s[i]);if(t&&t.defaultProps)for(i in s=t.defaultProps,s)a[i]===void 0&&(a[i]=s[i]);return{$$typeof:ot,type:t,key:l,ref:r,props:a,_owner:nt.current}}R.Fragment=it;R.jsx=$;R.jsxs=$;F.exports=R;var w=F.exports,P,H=X;P=H.createRoot,H.hydrateRoot;async function at(t){const s=t.serialize(),e={};for(const i of t.computeExecutionOrder(!1,0)){const a=s.nodes.find(p=>p.id===i.id);if(i.isVirtualNode){i.applyToGraph&&i.applyToGraph(s);continue}if(i.mode===2||i.mode===4)continue;const l={},r=i.widgets;if(r)for(const p in r){const o=r[p];(!o.options||o.options.serialize!==!1)&&(l[o.name]=o.serializeValue?await o.serializeValue(a,p):o.value)}for(let p in i.inputs){let o=i.getInputNode(p);if(o){let c=i.getInputLink(p);for(;o.mode===4||o.isVirtualNode;){let u=!1;if(o.isVirtualNode)c=o.getInputLink(c.origin_slot),c&&(o=o.getInputNode(c.target_slot),o&&(u=!0));else if(c&&o.mode===4){let y=[c.origin_slot];if(o.inputs){y=y.concat(Object.keys(o.inputs));for(let d in y)if(d=y[d],o.inputs[d].type===i.inputs[p].type){c=o.getInputLink(d),c&&(o=o.getInputNode(d)),u=!0;break}}}if(!u)break}c&&(l[i.inputs[p].name]=[String(c.origin_id),parseInt(c.origin_slot)])}}e[String(i.id)]={inputs:l,class_type:i.comfyClass}}for(const i in e)for(const a in e[i].inputs)Array.isArray(e[i].inputs[a])&&e[i].inputs[a].length===2&&!e[e[i].inputs[a][0]]&&delete e[i].inputs[a];return{workflow:s,output:e}}async function lt(){const t=await M.get("/api/object_info");if(t.status===200)return t.data}async function ut(t){const s=await at(t),e=await M.post("/api/workflow",{workflow:s.output});if(e.status===200)return console.log(e.data),await e.data;throw{response:await e.data}}const A=n.union([n.number().int(),n.string()]),W=n.union([n.object({0:n.number(),1:n.number()}).passthrough().transform(t=>[t[0],t[1]]),n.tuple([n.number(),n.number()])]),pt=n.object({collapsed:n.boolean().optional(),pinned:n.boolean().optional(),allow_interaction:n.boolean().optional(),horizontal:n.boolean().optional(),skip_repeated_outputs:n.boolean().optional()}).passthrough(),D=n.union([n.string(),n.array(n.string()),n.number()]),j=n.union([n.number().int(),n.string().transform(t=>parseInt(t)).refine(t=>!isNaN(t),{message:"Invalid number"})]),ct=n.object({name:n.string(),type:D,link:n.number().nullable().optional(),slot_index:j.optional()}).passthrough(),dt=n.object({name:n.string(),type:D,links:n.array(n.number()).nullable().optional(),slot_index:j.optional()}).passthrough(),ft=n.object({"Node name for S&R":n.string().optional()}).passthrough(),ht=n.union([n.array(n.any()),n.record(n.any())]),gt=n.object({id:A,type:n.string(),pos:W,size:W,flags:pt,order:n.number(),mode:n.number(),inputs:n.array(ct).optional(),outputs:n.array(dt).optional(),properties:ft,widgets_values:ht.optional(),color:n.string().optional(),bgcolor:n.string().optional()}).passthrough(),mt=n.tuple([n.number(),A,j,A,j,D]),yt=n.object({title:n.string(),bounding:n.tuple([n.number(),n.number(),n.number(),n.number()]),color:n.string().optional(),font_size:n.number().optional(),locked:n.boolean().optional()}).passthrough(),_t=n.object({links_ontop:n.boolean().optional(),align_to_grid:n.boolean().optional()}).passthrough(),wt=n.object({last_node_id:n.number(),last_link_id:n.number(),nodes:n.array(gt),links:n.array(mt),groups:n.array(yt).optional(),config:_t.optional().nullable(),version:n.number()});function bt(t){try{const s=JSON.parse(t),e=wt.parse(s);return console.log("Validation successful:",e),e}catch(s){throw s instanceof n.ZodError?console.error("Validation error:",s.errors):console.error("Parsing error:",s),Error(s)}}const vt=(t,s,e)=>{var a;const i=(a=e.target.files)==null?void 0:a[0];if(i&&s){const l=new FileReader;return l.onload=r=>{var p;try{const o=(p=r.target)==null?void 0:p.result,c=bt(o);console.log(c),s.clear(),s.configure(c),t&&(t.value=""),C.success("Loading Workflow Success",{position:"top-right",autoClose:5e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",style:{marginTop:"1.25em"}})}catch{C.error("Error loading workflow file. Please ensure it is a valid workflow.",{position:"top-right",autoClose:5e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",style:{marginTop:"1.25em"}})}},l.onerror=()=>{C.error("Error reading file",{position:"top-right",autoClose:5e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",style:{marginTop:"1.25em"}})},l.readAsText(i),i.name}};function Ot({graph:t,canvas:s}){const e=E.useRef(null),[i,a]=E.useState(!1),[l,r]=E.useState(!0),[p,o]=E.useState(null),[c,u]=E.useState("untitled"),y=()=>{var f;(f=e.current)==null||f.click()},d=()=>{if(t){const f=JSON.stringify(t.serialize()),b=new Blob([f],{type:"text/plain;charset=utf-8"}),L=prompt("Enter Filename : ",`workflow-${Date.now()}`);if(L===null)return;Q.saveAs(b,`${L}.json`),o(t.serialize()),u(L)}},m=()=>{t&&confirm("Clear workflow?")&&(t.clear(),C.info("Workflow Cleared",{position:"top-right",autoClose:5e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",style:{marginTop:"1.25em"}}),u("untitled"),s.ds.offset=[0,0],s.setZoom(1,[0,0]),s.setDirty(!0,!0))},_=async()=>{try{const f=await ut(t);await C.success("Send Workflow Success",{position:"top-right",autoClose:5e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",style:{marginTop:"1.25em"}})}catch(f){console.error(f),await C.error(f.response.data.error.message,{position:"top-right",autoClose:5e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",style:{marginTop:"1.25em"}})}};return w.jsxs(w.Fragment,{children:[w.jsx(tt,{children:w.jsxs("title",{children:[l?"":"*",c+" ","- AdvFBP"]})}),w.jsxs("div",{className:"topbar",children:[w.jsxs("div",{className:"leftmenu",children:[w.jsxs("button",{className:"buttonmenu",onClick:d,children:[w.jsx("i",{className:"pi pi-save"})," Save"]}),w.jsxs("button",{className:"buttonmenu",onClick:y,children:[w.jsx("i",{className:"pi pi-upload"})," Load"]}),w.jsx("input",{type:"file",ref:e,onChange:f=>{const b=vt(e.current,t,f);b&&u(b.split(".")[0])},accept:".json",style:{display:"none"}}),w.jsxs("button",{className:"buttonmenu",onClick:m,children:[w.jsx("i",{className:"pi pi-eraser"})," Clear"]})]}),w.jsx("div",{className:"rightmenu",children:w.jsx("button",{className:"buttonmenuright",onClick:async()=>{await _()},children:i?w.jsxs("span",{children:[w.jsx("i",{className:"pi pi-stop"})," Interrupt Workflow"]}):w.jsxs("span",{children:[w.jsx("i",{className:"pi pi-play"})," Run Workflow"]})})})]})]})}const G=Symbol(),V=Symbol();function kt(t,s,e,i,a){console.log(e);const l=50;function r(o){var m,_;if(t.widgets[0].last_y==null)return;let c=t.widgets[0].last_y,u=o[1]-c,y=0;const d=[];for(let f=0;f<t.widgets.length;f++){const b=t.widgets[f];b.type==="customtext"?d.push(b):b.computeSize?y+=b.computeSize(null)[1]+4:y+=h.LiteGraph.NODE_WIDGET_HEIGHT+4}u-=y,u/=d.length+(((m=t.imgs)==null?void 0:m.length)||0),u<l&&(u=l,t.size[1]=c+y+u*(d.length+(((_=t.imgs)==null?void 0:_.length)||0)),t.graph.setDirtyCanvas(!0));for(const f of t.widgets)f.y=c,f.type==="customtext"?(c+=u,f.computedHeight=u-d.length*4):f.computeSize?c+=f.computeSize()[1]+4:c+=h.LiteGraph.NODE_WIDGET_HEIGHT+4;t.inputHeight=u}const p={type:"customtext",name:s,get value(){return this.inputEl.value},set value(o){this.inputEl.value=o},draw:function(o,c,u,y,d){this.parent.inputHeight||r(t.size);const m=a.ds.scale>.5&&this.type==="customtext",_=10,f=o.canvas.getBoundingClientRect(),b=new DOMMatrix().scaleSelf(f.width/o.canvas.width,f.height/o.canvas.height).multiplySelf(o.getTransform()).translateSelf(_,_+y),L=new DOMMatrix().scaleSelf(b.a,b.d);Object.assign(this.inputEl.style,{transformOrigin:"0 0",transform:L,left:`${b.a+b.e}px`,top:`${b.d+b.f}px`,width:`${u-_*2}px`,height:`${this.parent.inputHeight-_*2}px`,position:"absolute",background:t.color?t.color:"",color:t.color?"white":"",zIndex:i._nodes.indexOf(t)}),this.inputEl.hidden=!m}};if(p.inputEl=document.createElement("textarea"),p.inputEl.className="comfy-multiline-input",p.inputEl.value=e.defaultVal,p.inputEl.placeholder=e.placeholder||"",document.addEventListener("mousedown",function(o){p.inputEl.contains(o.target)||p.inputEl.blur()}),p.parent=t,document.body.appendChild(p.inputEl),t.addCustomWidget(p),a.onDrawBackground=function(){for(let o in i._nodes){const c=i._nodes[o];for(let u in c.widgets){let y=c.widgets[u];Object.hasOwn(y,"inputEl")&&(y.inputEl.style.left="-8000px",y.inputEl.style.position="absolute")}}},t.onRemoved=function(){for(let o in this.widgets)this.widgets[o].inputEl&&this.widgets[o].inputEl.remove()},p.onRemove=()=>{var o;(o=p.inputEl)==null||o.remove(),--t[G]||(t.onResize=t[V],delete t[G],delete t[V])},t[G])t[G]++;else{t[G]=1;const o=t[V]=t.onResize;t.onResize=function(c){r(c),o&&o.apply(this,arguments)}}return{minWidth:400,minHeight:200,widget:p}}function q(t,s){let e=t[1].default,{min:i,max:a,step:l}=t[1];return e==null&&(e=0),i==null&&(i=Number.MIN_SAFE_INTEGER),a==null&&(a=Number.MAX_SAFE_INTEGER),l==null&&(l=s),t[1].min=i,t[1].max=a,t[1].step=1*l,{val:e,config:{...t[1]}}}function U(t){return t==="slider"?"slider":"number"}function xt(t,s,e){let i=U(e[1].display);const{val:a,config:l}=q(e,1);return Object.assign(l,{precision:0}),{widget:t.addWidget(i,s,a,function(r){const p=this.options.step/10;let o=this.options.min%p;isNaN(o)&&(o=0),this.value=Math.round((r-o)/p)*p+o},l)}}const T={FLOAT(t,s,e){let i=U(e[1].display),{val:a,config:l}=q(e,.5);return{widget:t.addWidget(i,s,a,()=>{},l)}},INT(t,s,e){return xt(t,s,e)},BOOLEAN(t,s,e){let i=e[1].default;return{widget:t.addWidget("toggle",s,i,()=>{},{on:e[1].label_on,off:e[1].label_off})}},STRING(t,s,e,i,a){const l=e[1].defaultVal?e[1].defaultVal:"",r=!!e[1].multiline;let p;return r?p=kt(t,s,e[1],i,a):p={widget:t.addWidget("text",s,l,()=>{},{})},e[1].dynamicPrompts!=null&&(p.widget.dynamicPrompts=e[1].dynamicPrompts),p},COMBO(t,s,e){const i=e[0];let a=i[0];return e[1]&&e[1].default&&(a=e[1].default),{widget:t.addWidget("combo",s,a,()=>{},{values:i})}}};async function Nt(t,s){class e{constructor(){v(this,"properties");v(this,"serialize_widgets");v(this,"isVirtualNode");v(this,"color",h.LGraphCanvas.node_colors.yellow.color);v(this,"bgcolor",h.LGraphCanvas.node_colors.yellow.bgcolor);v(this,"groupcolor",h.LGraphCanvas.node_colors.yellow.groupcolor);this.properties||(this.properties={},this.properties.text=""),T.STRING(this,"",["",{defaultVal:this.properties.text,multiline:!0}],t,s),this.serialize_widgets=!0,this.isVirtualNode=!0}}v(e,"category"),h.LiteGraph.registerNodeType("Note",Object.assign(e,{title_mode:h.LiteGraph.NORMAL_TITLE,title:"Note",collapsable:!0})),e.category="utils"}async function Lt(t,s){const i=class i{constructor(){v(this,"size");v(this,"__outputType");v(this,"inputs");v(this,"outputs");v(this,"isVirtualNode");v(this,"horizontal");v(this,"properties");this.properties||(this.properties={}),this.properties.showOutputText=i.defaultVisibility,this.properties.horizontal=!1;const l=this;l.addInput("","*"),l.addOutput(this.properties.showOutputText?"*":"","*"),l.onConnectionsChange=function(r,p,o,c){var S;if(this.applyOrientation(),o&&r===h.LiteGraph.OUTPUT&&new Set(this.outputs[0].links.map(x=>t.links[x].type).filter(x=>x!=="*")).size>1){const x=[];for(let g=0;g<this.outputs[0].links.length-1;g++){const k=this.outputs[0].links[g],N=t.links[k];x.push(N)}for(const g of x)t.getNodeById(g.target_id).disconnectInput(g.target_slot)}let u=this,y=[],d=null,m=null;for(;u;){y.unshift(u);const O=u.inputs[0].link;if(O!==null){const x=t.links[O],g=t.getNodeById(x.origin_id);if(g.constructor.type==="Reroute")g===this?(u.disconnectInput(x.target_slot),u=null):u=g;else{m=u,d=((S=g.outputs[x.origin_slot])==null?void 0:S.type)??null;break}}else{u=null;break}}const _=[this];let f=null;for(;_.length;){u=_.pop();const O=(u.outputs?u.outputs[0].links:[])||[];if(O.length)for(const x of O){const g=t.links[x];if(!g)continue;const k=t.getNodeById(g.target_id);if(k.constructor.type==="Reroute")_.push(k),y.push(k);else{const z=k.inputs&&k.inputs[g==null?void 0:g.target_slot]&&k.inputs[g.target_slot].type?k.inputs[g.target_slot].type:null;d&&z!==d?k.disconnectInput(g.target_slot):f=z}}}const b=d||f||"*",L=h.LGraphCanvas.link_type_colors[b];for(const O of y){O.outputs[0].type=d||"*",O.__outputType=b,O.outputs[0].name=O.properties.showOutputText?b:"",O.size=O.computeSize(),O.applyOrientation();for(const x of O.outputs[0].links||[]){const g=t.links[x];g&&(g.color=L)}}if(m){const O=t.links[m.inputs[0].link];O&&(O.color=L)}},this.clone=function(){const r=i.prototype.clone.apply(this);return r.removeOutput(0),r.addOutput(this.properties.showOutputText?"*":"","*"),r.size=r.computeSize(),r},this.isVirtualNode=!0}getExtraMenuOptions(l,r){r.unshift({content:(this.properties.showOutputText?"Hide":"Show")+" Type",callback:()=>{this.properties.showOutputText=!this.properties.showOutputText,this.properties.showOutputText?this.outputs[0].name=this.__outputType||this.outputs[0].type:this.outputs[0].name="",this.size=this.computeSize(),this.applyOrientation(),t.setDirtyCanvas(!0,!0)}},{content:(i.defaultVisibility?"Hide":"Show")+" Type By Default",callback:()=>{i.setDefaultTextVisibility(!i.defaultVisibility)}},{content:"Set "+(this.properties.horizontal?"Horizontal":"Vertical"),callback:()=>{this.properties.horizontal=!this.properties.horizontal,this.applyOrientation()}})}applyOrientation(){this.horizontal=this.properties.horizontal,this.horizontal?this.inputs[0].pos=[this.size[0]/2,0]:delete this.inputs[0].pos,t.setDirtyCanvas(!0,!0)}computeSize(){return[this.properties.showOutputText&&this.outputs&&this.outputs.length?Math.max(75,h.LiteGraph.NODE_TEXT_SIZE*this.outputs[0].name.length*.6+40):75,26]}clone(){}static setDefaultTextVisibility(l){i.defaultVisibility=l,l?localStorage["Comfy.RerouteNode.DefaultVisibility"]="true":delete localStorage["Comfy.RerouteNode.DefaultVisibility"]}};v(i,"category"),v(i,"defaultVisibility");let e=i;e.setDefaultTextVisibility(!!localStorage["Comfy.RerouteNode.DefaultVisibility"]),h.LiteGraph.registerNodeType("Reroute",Object.assign(e,{title_mode:h.LiteGraph.NO_TITLE,title:"Reroute",collapsable:!1})),e.category="utils"}const It={dark:{id:"dark",name:"Dark (Default)",colors:{node_slot:{INT:"#FFD500",FLOAT:"#A8DADC",STRING:"#ad7452",COMBO:"#FFA931",NDARRAY:"#6EE7B7"}}}};async function Et(t,s,e){const i=o=>Object.keys(o).sort().reduce((c,u)=>(c[u]=o[u],c),{});function a(){var o=[];const c=t;for(const y in c){const d=c[y];var u=d.input.required;d.input.optional!==void 0&&(u=Object.assign({},d.input.required,d.input.optional));for(const m in u){const f=u[m][0];Array.isArray(f)||o.push(f)}for(const m in d.output){const _=d.output[m];o.push(_)}}return o}function l(o){var c=a();for(const u of c)o.colors.node_slot[u]||(o.colors.node_slot[u]="");return o.colors.node_slot=i(o.colors.node_slot),o}const r=async o=>{if(o=await l(o),o.colors){if(o.colors.node_slot&&(Object.assign(e.default_connection_color_byType,o.colors.node_slot),Object.assign(h.LGraphCanvas.link_type_colors,o.colors.node_slot)),o.colors.litegraph_base){e.node_title_color=o.colors.litegraph_base.NODE_TITLE_COLOR,e.default_link_color=o.colors.litegraph_base.LINK_COLOR;for(const c in o.colors.litegraph_base)o.colors.litegraph_base.hasOwnProperty(c)&&h.LiteGraph.hasOwnProperty(c)&&(h.LiteGraph[c]=o.colors.litegraph_base[c])}e.draw(!0,!0)}};let p=It.dark;await r(p)}function Tt(){h.LiteGraph.search_filter_enabled=!0,h.LiteGraph.middle_click_slot_add_default_node=!0}async function Ct(t,s,e){var c;var i=s.name;const a=(c=s.input)==null?void 0:c.required;for(const u in a){var l=a[u];if(typeof l[0]!="string")continue;var r=l[0];if(r in T){var p=l[1];if(!(p!=null&&p.forceInput))continue}if(r in e.slot_types_default_out||(e.slot_types_default_out[r]=["Reroute"]),e.slot_types_default_out[r].includes(i))continue;e.slot_types_default_out[r].push(i);const y=r.toLocaleLowerCase();y in h.LiteGraph.registered_slot_in_types||(h.LiteGraph.registered_slot_in_types[y]={nodes:[]}),h.LiteGraph.registered_slot_in_types[y].nodes.push(t.comfyClass)}var o=s.output;for(const u in o){var r=o[u];r in e.slot_types_default_in||(e.slot_types_default_in[r]=["Reroute"]),e.slot_types_default_in[r].push(i),r in h.LiteGraph.registered_slot_out_types||(h.LiteGraph.registered_slot_out_types[r]={nodes:[]}),h.LiteGraph.registered_slot_out_types[r].nodes.push(t.comfyClass),h.LiteGraph.slot_types_out.includes(r)||h.LiteGraph.slot_types_out.push(r)}h.LiteGraph.slot_types_default_out={},h.LiteGraph.slot_types_default_in={};for(const u in e.slot_types_default_out)h.LiteGraph.slot_types_default_out[u]=e.slot_types_default_out[u].slice(0,5);for(const u in e.slot_types_default_in)h.LiteGraph.slot_types_default_in[u]=e.slot_types_default_in[u].slice(0,5)}async function St(t,s,e){await Nt(s,e),await Lt(s),await Et(t,s,e)}async function zt(t,s,e){await Tt()}async function Gt(t,s,e){var a;const i={slot_types_default_out:{},slot_types_default_in:{}};for(const l in t){const r=t[l],p=(a=class extends h.LGraphNode{constructor(u){var f,b,L,S,O,x;super(u);v(this,"comfyClass",r.name);v(this,"graph",s);v(this,"canvas",e);const y=r.input.required;var d=r.input.required;r.input.optional!=null&&(d=Object.assign({},r.input.required,r.input.optional));const m={minWidth:1,minHeight:1};for(const g in d){const k=d[g],N=k[0],z=k[1]??{},I=[N,z],K=y&&g in y;let B=!0;(f=I[1])!=null&&f.forceInput?this.addInput(g,N):Array.isArray(N)?Object.assign(m,T.COMBO(this,g,I)||{}):`${N}:${g}`in T?Object.assign(m,T[`${N}:${g}`](this,g,I,this.graph,this.canvas)||{}):N in T?Object.assign(m,T[N](this,g,I,this.graph,this.canvas)||{}):(this.addInput(g,N),B=!1),B&&(m!=null&&m.widget)&&((b=m.widget).options??(b.options={}),K||(m.widget.options.inputIsOptional=!0),(L=I[1])!=null&&L.forceInput&&(m.widget.options.forceInput=!0),(S=I[1])!=null&&S.defaultInput&&(m.widget.options.defaultInput=!0),(O=I[1])!=null&&O.advanced&&(m.widget.advanced=!0),(x=I[1])!=null&&x.hidden&&(m.widget.hidden=!0))}for(const g in r.output){let k=r.output[g];k instanceof Array&&(k="COMBO");const N=r.output_name[g]||k,I={shape:r.output_is_list[g]?h.LiteGraph.GRID_SHAPE:h.LiteGraph.CIRCLE_SHAPE};this.addOutput(N,k,I)}const _=this.computeSize();_[0]=Math.max(m.minWidth,_[0]*1.5),_[1]=Math.max(m.minHeight,_[1]),this.size=_,this.serialize_widgets=!0}configure(u){const y=(d,m)=>{const _={...m};if(d.widget===void 0&&m.widget!==void 0)return this.inputs.push(d),m;for(const f of["name","type","shape"])d[f]!==void 0&&(_[f]=d[f]);return _};for(const d of["inputs","outputs"]){const m=u[d]??[];u[d]=m.map((_,f)=>y(this[d][f]??{},_))}super.configure(u)}},v(a,"title",r.display_name||r.name),v(a,"nodeData",r),v(a,"category"),a);h.LiteGraph.registerNodeType(l,p),p.category=r.category,await Ct(new p,r,i),console.log(i)}}async function jt(t,s,e){const i=new h.LGraph,a=new h.LGraphCanvas(t,i);function l(){const p=Math.max(window.devicePixelRatio,1),{width:o,height:c}=t.getBoundingClientRect();t.width=Math.round(o*p),t.height=Math.round(c*p),t.getContext("2d").scale(p,p),a.draw(!0,!0)}l(),window.addEventListener("resize",l),h.LiteGraph.release_link_on_empty_shows_menu=!0,h.LiteGraph.alt_drag_do_clone_nodes=!0,h.LiteGraph.clearRegisteredTypes();const r=await lt();await zt(),await Gt(r,i,a),await St(r,i,a),s(i),e(a)}function Rt({setGraph:t,setCanvas:s,canvasRef:e}){E.useEffect(()=>{e.current&&jt(e.current,t,s)},[])}function Vt(){const t=E.useRef(null),[s,e]=E.useState(void 0),[i,a]=E.useState(void 0);return Rt({setGraph:e,setCanvas:a,canvasRef:t}),w.jsxs(w.Fragment,{children:[w.jsx(Ot,{graph:s,canvas:i}),w.jsx("canvas",{style:{position:"absolute",zIndex:0,touchAction:"none"},ref:t,id:"graph-canvas"})]})}P(document.getElementById("root")).render(w.jsxs(w.Fragment,{children:[w.jsx(Vt,{}),w.jsx(Y,{})]}));
